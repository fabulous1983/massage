<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pleasure Meter</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      margin: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      overflow: hidden;
      user-select: none; /* Prevent text selection */
    }

    #startButton {
      background-color: #FF6473;
      color: white;
      padding: 20px 40px;
      font-size: 24px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    #title {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 36px;
      font-weight: bold;
      color: white;
    }

    #inputArea {
      display: none;
      width: 100vw;
      height: 100vh;
      position: absolute;
      top: 0;
      left: 0;
      background: linear-gradient(to bottom, #CBE1EF, #9ACDE0, #5EA9BE, #F3BFB3, #FFDDD3, #FDF8E2); /* Based on your color scheme */
    }

    #pleasureLevel {
      position: absolute;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 36px;
      font-weight: bold;
      color: #333; /* Modern, clean look */
    }

    #ideaMessage {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #FF6473;
      padding: 10px;
      border-radius: 10px;
      display: none;
    }

    #touchArea {
      position: absolute;
      top: 10%; /* Start touch area 10% from top */
      height: 75%; /* 75% of the screen height for sliding */
      width: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    /* Lines to divide each level section */
    .level-line {
      border-bottom: 2px solid rgba(255, 255, 255, 0.5); /* Semi-transparent lines */
      flex-grow: 1;
    }
  </style>
</head>
<body>

  <!-- Start Screen -->
  <div id="startScreen">
    <div id="title">Pleasure Meter</div>
    <button id="startButton">Start</button>
  </div>

  <!-- Input Area -->
  <div id="inputArea">
    <div id="title">Pleasure Meter</div> <!-- Title on the lever screen -->
    <div id="pleasureLevel">5</div> <!-- Default level -->
    <div id="ideaMessage">That's the spot!</div> <!-- Idea prompt -->
    <div id="touchArea">
      <!-- 11 level areas (each represents a grade from 0 to 10) -->
      <div class="level-line" data-level="10"></div>
      <div class="level-line" data-level="9"></div>
      <div class="level-line" data-level="8"></div>
      <div class="level-line" data-level="7"></div>
      <div class="level-line" data-level="6"></div>
      <div class="level-line" data-level="5"></div>
      <div class="level-line" data-level="4"></div>
      <div class="level-line" data-level="3"></div>
      <div class="level-line" data-level="2"></div>
      <div class="level-line" data-level="1"></div>
      <div class="level-line" data-level="0"></div>
    </div>
  </div>

  <script>
    const pleasureApp = (() => {
      let pleasureLevel = 5; // Starting level
      let isHumming = true;
      const jingle = new Audio('jingle.mp3'); // Jingle sound

      // AudioContext for humming sound
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      oscillator.type = 'sine';
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      oscillator.start();

      // Start the Experience
      const startExperience = () => {
        document.getElementById('startScreen').style.display = 'none';
        document.getElementById('inputArea').style.display = 'block';
        updatePleasureLevel(5); // Start at level 5 with sound humming
        audioContext.resume(); // Start audio context after user interaction
      };

      // Update Pleasure Level and Adjust Sound Frequency
      const updatePleasureLevel = (newLevel) => {
        pleasureLevel = newLevel;
        document.getElementById('pleasureLevel').innerText = newLevel;
        triggerHapticFeedback();
        // Adjust the pitch of the humming sound based on the pleasure level
        const newFrequency = 300 + (newLevel * 20); // Subtle pitch changes (range: 300-500 Hz)
        oscillator.frequency.setValueAtTime(newFrequency, audioContext.currentTime);
      };

      // Toggle Humming Sound
      const toggleHumming = () => {
        if (isHumming) {
          gainNode.gain.setValueAtTime(0, audioContext.currentTime); // Mute
        } else {
          gainNode.gain.setValueAtTime(0.2, audioContext.currentTime); // Unmute
        }
        isHumming = !isHumming;
      };

      // Haptic Feedback Debugging (Works on iPhone)
      const triggerHapticFeedback = () => {
        if (navigator.vibrate) {
          navigator.vibrate(50); // Vibration for 50ms
          console.log('Haptic feedback triggered');
        } else {
          console.log('Haptic feedback not supported on this device.');
        }
      };

      // Handle Clicks on Level Lines
      const handleLevelClick = (e) => {
        const level = e.target.getAttribute('data-level');
        if (level !== null) {
          updatePleasureLevel(Number(level));
        }
      };

      // Handle Sliding Input (finger movement up/down)
      const handleTouchMove = (e) => {
        const screenHeight = window.innerHeight;
        const touchY = e.touches[0].clientY;

        // Calculate new level based on touch position
        const newLevel = Math.round(((screenHeight * 0.75 - touchY) / (screenHeight * 0.5)) * 10);

        // Ensure levels are within range
        if (newLevel <= 10 && newLevel >= 0) {
          updatePleasureLevel(newLevel);
        } else if (newLevel > 10) {
          updatePleasureLevel(10);
        } else {
          updatePleasureLevel(0);
        }
      };

      // Handle Double-click to Show "That's the Spot" and Play Jingle
      const handleDoubleClick = () => {
        jingle.play();
        document.getElementById('ideaMessage').style.display = 'block'; // Show idea prompt
        setTimeout(() => {
          document.getElementById('ideaMessage').style.display = 'none';
        }, 5000); // Hide after 5 seconds
      };

      // Event Listeners Setup
      const initListeners = () => {
        const touchArea = document.getElementById('touchArea');

        // Handle click on each level section
        touchArea.addEventListener('click', handleLevelClick);

        // Handle sliding up/down
        touchArea.addEventListener('touchmove', handleTouchMove);

        // Handle single-click to toggle sound
        touchArea.addEventListener('click', toggleHumming);

        // Handle double-click for "That's the Spot"
        touchArea.addEventListener('dblclick', handleDoubleClick);
      };

      return {
        startExperience,
        initListeners
      };
    })();

    // Initialize Event Listeners on Start Button Click
    document.getElementById('startButton').addEventListener('click', () => {
      pleasureApp.startExperience();
      pleasureApp.initListeners();
    });
  </script>
</body>
</html>
